<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets">


<h:head>
	<h:outputStylesheet library="css" name="bootstrap.min.css" />
</h:head>


<h:body>
	<ui:composition>

		<h:form id="modalForm">

			<div class="modal" id="exampleModal" tabindex="-1" role="dialog"
				aria-labelledby="exampleModalLabel" aria-hidden="true"
				style="width: 1000px; height: 720px; margin-left: 500px;">
				<div class="modal-dialog modal-lg" role="dialog">
					<div class="modal-content" style="height: 650px;">
						<div class="modal-header">
							<h5 class="modal-title" id="exampleModalLabel">New Item</h5>
							<button type="button" class="close" data-dismiss="modal"
								aria-label="Close">
								<span aria-hidden="true" />
							</button>
						</div>
						<div class="row" style="height: 500px">
							<div class="col-md-6">
								<div class="modal-body" style="overflow-y: inherit;">
									<div class="form-group">
										<div class="row justify-content-center">
											<div class="col-md-3">
												<h:outputText value="Name" />
											</div>
											<div class="col-md-9">
												<h:inputText class="input-block-level"
													value="#{item.itemDTO.name}"
													validatorMessage="Name must have minimum 2 characters,max 30">
													<f:validateRegex pattern="^.{2,30}$"></f:validateRegex>
												</h:inputText>
											</div>

										</div>
									</div>
									<div class="form-group">
										<div class="row justify-content-center">
											<div class="col-md-3">
												<h:outputText value="Description" />
											</div>
											<div class="col-md-9">
												<h:inputText class="input-block-level"
													value="#{item.itemDTO.description}" />
											</div>
										</div>
									</div>
									<div class="form-group">
										<div class="row justify-content-center">
											<div class="col-md-3">
												<h:outputText value="Category" />
											</div>
											<div class="col-md-9">
												<h:inputText id="modalCategory" disabled="true"
													class="input-block-level"
													validatorMessage="Category must have minimum 1 characters,max 30">
													<f:validateRegex pattern="^.{1,30}$"></f:validateRegex>
												</h:inputText>
												<h:inputHidden id="hiddenCategory"
													value="#{item.categoryID}" />
											</div>
										</div>
									</div>
									<div class="form-group">
										<div class="row justify-content-center">
											<div class="col-md-3">
												<h:outputText value="Initial Price" />
											</div>
											<div class="col-md-9">
												<h:inputText value="#{item.itemDTO.initialPrice}"
													class="input-block-level"
													validatorMessage="Positive doubles only">
													<f:validateDoubleRange minimum="1.00"
														maximum="99999999999999.11" />
												</h:inputText>
											</div>
										</div>
									</div>
									<div class="form-group">
										<div class="row justify-content-center">
											<div class="col-md-3">
												<h:outputText value="Opening date"
													styleClass="control-label" />
											</div>
											<div class="col-md-9">
												<div class="input-group date">
													<h:inputText class="input-block-level"
														id="openingDatePicker" value="#{item.openingDate}"
														validatorMessage="Please select an opening date.">
														<f:validateRegex pattern="^.{4,30}$"></f:validateRegex>
													</h:inputText>
													<span class="input-group-addon"><i
														class="typcn typcn-calendar"></i> </span>
												</div>
											</div>

										</div>
										<div class="row justify-content-center">
											<div class="col-md-3" />
											<div class="col-md-9">
												<div class="input-group bootstrap-timepicker timepicker">
													<h:inputText id="openingTimePicker"
														class="input-block-level" value="#{item.openingTime}" />
													<span class="input-group-addon"><i
														class="typcn typcn-time"></i></span>
												</div>

												<script type="text/javascript">
                 					   $('#modalForm\\:openingTimePicker').timepicker({
                       					 icons: {
                         				 up: 'typcn typcn-arrow-up',
                         				 down: 'typcn typcn-arrow-down'
                     				     }
                  						    });
              						  </script>
											</div>
										</div>
									</div>

									<div class="form-group">
										<div class="row justify-content-center">
											<div class="col-md-3">
												<h:outputText value="Closing date"
													styleClass="control-label  " />
											</div>

											<div class="col-md-9">
												<div class="input-group date">
													<h:inputText class="input-block-level"
														id="closingDatePicker" value="#{item.closingDate}"
														validatorMessage="Please select a closing date.">
														<f:validateRegex pattern="^.{4,30}$"></f:validateRegex>
													</h:inputText>
													<div class="input-group-addon">
														<span class="typcn typcn-calendar" />
													</div>
												</div>
											</div>
										</div>
										<div class="row justify-content-center">
											<div class="col-md-3" />
											<div class="col-md-9">
												<div class="input-group bootstrap-timepicker timepicker">
													<h:inputText id="closingTimePicker"
														class="input-block-level" value="#{item.closingTime}" />
													<span class="input-group-addon"><i
														class="typcn typcn-time"></i></span>
												</div>
												<script type="text/javascript">
                 					   $('#modalForm\\:closingTimePicker').timepicker({
                     
                       					 icons: {
                         				 up: 'typcn typcn-arrow-up',
                         				 down: 'typcn typcn-arrow-down'
                     				     }
                  						    });
              						  </script>
											</div>
										</div>

									</div>
									<div class="form-group">
										<div class="row">
											<div class="col-md-4" />
											<button type="button" class="btn btn-info"
												data-dismiss="modal">Close</button>

											<div class="col-md-1"></div>
											<h:commandButton action="#{item.addItem}"
												styleClass="btn btn-info" value="Save Item">
											</h:commandButton>
										</div>

									</div>
								</div>


							</div>
							<div class="col-md-6" style="padding-right: 40px;">

								<ui:include src="/items/item-category-tree.xhtml" />

							</div>
						</div>
						<div class="row ">
							<div class="col-md-1" />
							<h:messages style="color:red;margin:12px;font-size:100%" />
						</div>

					</div>
				</div>
			</div>
		</h:form>


		<h:form id="itemDefiningForm" style="width:100%">
			<h:dataTable id="table" value="#{item.itemsDTO}" var="itemDTO"
				styleClass="table table-stripped table-bordered dataTable no-footer "
				cellspacing="0" width="100%" role="grid" style="width: 100%;"
				headerClass="order-table-header"
				rowClasses="order-table-odd-row,order-table-even-row">

				<h:column>
					<f:facet name="header">Name</f:facet>
					<h:inputText style="width:87%" class="form-control"
						value="#{itemDTO.name}" styleClass="form-control"
						rendered="#{itemDTO.editable}" />
					<h:outputText value="#{itemDTO.name}"
						rendered="#{not itemDTO.editable}" />
				</h:column>

				<h:column>
					<f:facet name="header">Description</f:facet>
					<h:inputText style="width:87%" value="#{itemDTO.description}"
						styleClass="form-control" rendered="#{itemDTO.editable}" />
					<h:outputText value="#{itemDTO.description}"
						rendered="#{not itemDTO.editable}" />
				</h:column>

				<h:column>
					<f:facet name="header">Categories</f:facet>
					<h:inputText style="width:87%" value="#{itemDTO.category.text}"
						styleClass="form-control" rendered="#{itemDTO.editable}" />
					<h:outputText value="#{itemDTO.category.text}"
						rendered="#{not itemDTO.editable}" />
				</h:column>

				<h:column>
					<f:facet name="header">Initial price</f:facet>
					<h:inputText style="width:87%" value="#{itemDTO.initialPrice}"
						styleClass="form-control" rendered="#{itemDTO.editable}" />
					<h:outputText value="#{itemDTO.initialPrice}"
						rendered="#{not itemDTO.editable}" />
				</h:column>

				<h:column>
					<f:facet name="header">Best bid</f:facet>
					<h:outputText value="#{itemDTO.bestBid}" />
				</h:column>

				<h:column>
					<f:facet name="header">Bids</f:facet>
					<h:outputText value="#{itemDTO.bids}" />
				</h:column>



				<h:column>
					<f:facet name="header">Opening Date</f:facet>
					<h:outputText value="#{itemDTO.openingDate}" />
				</h:column>

				<h:column>
					<f:facet name="header">Closing Date</f:facet>
					<h:outputText value="#{itemDTO.closingDate}" />
				</h:column>

				<h:column>
					<f:facet name="header">Status</f:facet>
					<div class="form-group">
						<h:selectOneMenu id="status" rendered="#{itemDTO.editable}"
							value="#{itemDTO.status}">
							<f:selectItem itemValue="OPEN" itemLabel="OPEN" />
							<f:selectItem itemValue="CLOSED" itemLabel="CLOSED" />
							<f:selectItem itemValue="NOT YET OPEN" itemLabel="NOT YET OPEN" />
							<f:selectItem itemValue="ABANDONED" itemLabel="ABANDONED" />
						</h:selectOneMenu>
					</div>
					<h:outputText value="#{itemDTO.status}"
						rendered="#{not itemDTO.editable}" />
				</h:column>

				<h:column>
					<f:facet name="header">Edit</f:facet>
					<h:commandButton styleClass="btn btn-info btn-block" value="Edit"
						action="#{item.editAction(itemDTO)}"
						rendered="#{not itemDTO.editable}" />
					<h:commandButton styleClass="btn btn-success btn-block"
						value="Save Changes" action="#{item.saveAction}"
						rendered="#{itemDTO.editable}" />
				</h:column>

				<h:column>
					<f:facet name="header">Remove</f:facet>
					<h:commandButton styleClass="btn btn-info btn-block" value="Remove"
						action="#{item.removeItem(itemDTO)}" />
				</h:column>
			</h:dataTable>
			<h:inputHidden id="hiddenOpeningDate" value="#{item.openingDate}" />
			<h:inputHidden id="hiddenClosingDate" value="#{item.closingDate}" />




			<script>
			$(document).ready(function() {
				$('#itemDefiningForm\\:table').DataTable();
			
				$("#modalForm\\:openingDatePicker").datepicker({
					format: 'yyyy/mm/dd'
				});
				
				$("#modalForm\\:openingDatePicker").on('changeDate', function() {
				    $('#modalForm\\:hiddenOpeningDate').val(
				            $('#modalForm\\:openingDatePicker').datepicker('getFormattedDate')
				        );
				});
				
				$("#modalForm\\:closingDatePicker").datepicker({
					format: 'yyyy/mm/dd'
				});
				
				$("#modalForm\\:closingDatePicker").on('changeDate', function() {
				    $('#modalForm\\:hiddenClosingDate').val(
				            $('#modalForm\\:closingDatePicker').datepicker('getFormattedDate')
				        );
				});
			});



			
		</script>
		</h:form>
		<div class="row pt-4 justify-content-center">
			<div class="col-md-2">
				<button type="button" class="btn btn-primary" data-toggle="modal"
					data-target="#exampleModal">Add New Item</button>
			</div>
		</div>
	</ui:composition>

</h:body>

</html>